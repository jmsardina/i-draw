$(function(){
  var paint = false;

  $("#drawing-canvas").on("mousedown", startDrawing);
  $("#drawing-canvas").on("mousemove", keepDrawing);
  $("#drawing-canvas").on("mouseup", stopDrawing);

  function startDrawing(e){
    paint = true;

    drawingContext.beginPath();
    drawingContext.moveTo(e.offsetX, e.offsetY)
  }

  function keepDrawing(e){
    if(paint){
      drawingContext.lineTo(e.offsetX, e.offsetY)
      drawingContext.stroke();
    }
  }

  function stopDrawing(e){
    paint = false;

    drawingContext.beginPath();
    drawingContext.arc(e.offsetX, e.offsetY, drawingContext.lineWidth/2, 0, Math.PI*2, true);
    drawingContext.fillStyle = drawingContext.strokeStyle;
    drawingContext.fill();

    recordHistory();
  }
})